<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>仿真评估工具</title>
    <script src="resource/bootstrap/js/bootstrap.min.js"></script>
    <link href="resource/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <style>
      .title {
        height: 40px;
        background-color: #4472c4;
        color: white;
        text-align: center;
        font-weight: bold;
        line-height: 40px;
      }
      .table{
        width:100%;
      }
      .table td{
        /*border-right:1px solid grey;*/
        width:60px;
      }
    </style>
  </head>
  <body style="width: 900px;background-color: #ffffff;">
    <div style="background-color: #f2f2f2;width:100%;height: 100%;padding:0px 5px 0px 5px;">
      <div>
        <div style="width:100%;height:600px;display:inline-block;background-color: #ffffff;vertical-align: top;">
<!--          左-->
          <div class="title">楼间对打天线布放位置辅助计算工具V1.0</div>
          <div style="padding:0px 5px 0px 5px;">
            <div>
              <h4>基本信息</h4>
              <table border="0" cellpadding="0" class="table">
                <tr>
                  <td>覆盖楼宇高度(m)</td>
                  <td>与对打楼宇间距(m)</td>
                  <td>水平波瓣角(°)</td>
                  <td>垂直波瓣角(°)</td>
                  <td>天线口功率(dbm)</td>
                  <td>天线增益(dbm)</td>
                  <td></td>
                  <td style="background-color: #0e90d2;">频段(Mhz)</td>
                </tr>
                <tr>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_H" value="60"></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_AH" value="30"></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_a" value="30"></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_b" value="10"></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_P" value="10"></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_G" value="15"></td>
                  <td></td>
                  <td><input type="text" class="form-control" placeholder="" style="width:60px;" id="input_F" value="900"></td>
                </tr>
              </table>

            </div>
            <div style="text-align: right;">
              <button style="width:100px;height:35px;" class="btn btn-xs btn-warning" id="btn_reset">重置</button>
              <button style="width:100px;height:35px;" class="btn btn-xs btn-primary" id="btn_add">添加</button>
              <button style="width:100px;height:35px;" class="btn btn-xs btn-success" id="btn_evaluation">开始计算</button>
            </div>
            <div class="row" style="padding: 5px 0px 5px 20px;">
              <div class="col-md-12" style="max-height: 400px;overflow-y: auto;">
              <table class="table table-striped table-bordered" id="table">
                <thead>
                <tr>
                  <th>序号</th>
                  <th>覆盖楼宇高度(m)</th>
                  <th>与对打楼宇间距(m)</th>
                  <th>水平波瓣角(°)</th>
                  <th>垂直波瓣角(°)</th>
                  <th>天线口功率(dbm)</th>
                  <th>天线增益(dbm)</th>
                  <th style="background-color: yellow;">建议天线与楼边距离(m)</th>
                  <th style="background-color: yellow;">建议天线挂高(m)</th>
                  <th style="background-color: yellow;">中心点RSRP(dbm)</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <template id="template">
      <tr>
        <td>{{number}}</td>
        <td>{{H}}</td>
        <td>{{A}}</td>
        <td>{{a}}</td>
        <td>{{b}}</td>
        <td>{{P}}</td>
        <td>{{G}}</td>
        <td>{{X}}</td>
        <td>{{Y}}</td>
        <td>{{Z}}</td>
      </tr>
    </template>
    <!-- You can also require other files to run in this process -->
    <script src="./renderer.js"></script>
    <script src="./resource/jquery.min.js"></script>
    <script src="./resource/layer/layer.js"></script>

    <script type="text/javascript">
      $().ready(function () {
        let number=1;
        let dataSet=[];

        $("#btn_add").click(function () {
          let item = {
            number:number++,
            H:$("#input_H").val(),
            A:$("#input_AH").val(),
            a:$("#input_a").val(),
            b:$("#input_b").val(),
            P:$("#input_P").val(),
            G:$("#input_G").val(),
            F:$("#input_F").val()
          };
          item["X"]=parseFloat(item.A)*Math.tan(parseFloat(item.a)*Math.PI/180/2);//X=A*tan(a/2)
          item["Y"]=parseFloat(item.H)-parseFloat(item.A)*Math.tan(parseFloat(item.b)*Math.PI/180/2);//Y=H-A*tan(b/2)
          item["Z"]=parseFloat(item.P)+parseFloat(item.G)-20*Math.log10(parseFloat(item.F))-20*Math.log10(parseFloat(item.A)/1000)-32.45;//Z=P+G-20lgF-20lg(A/1000)-32.45

          dataSet.push(item);


          renderer();
        });
        $("#btn_reset").click(function () {
          $("input").val("");
          renderer();
        });
        $("#btn_evaluation").click(function () {

        });

        /**
         * 渲染表格数据
         */
        function renderer() {
          $("#table tbody").empty();
          for(let i=0;i<dataSet.length;i++){
            let data = dataSet[i];
            let tr=$("#template").html();
            for(let key in data){
              tr=tr.replace("{{"+key+"}}",data[key]);
            }
            $("#table tbody").append(tr);
          }
        }
      });
    </script>
  </body>
</html>
